# –ù–∞—Å—Ç—É–ø–Ω—ñ 5 –ø—Ä–æ–±–ª–µ–º –¥–ª—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥—É UI

## 1. ‚úÖ –í–ò–ö–û–ù–ê–ù–û: –î—É–±–ª—é–≤–∞–Ω–Ω—è cleanup –ª–æ–≥—ñ–∫–∏ –≤ SaveSlotBackgroundScene.tsx

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `SaveSlotBackgroundScene.tsx` –º–∞–≤ –≤–ª–∞—Å–Ω—É cleanup –ª–æ–≥—ñ–∫—É (—Ä—è–¥–∫–∏ 1166-1207)
- –¶–µ –¥—É–±–ª—é–≤–∞–ª–æ cleanup –∑ `useWebGLSceneSetup.ts`, –∞–ª–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–æ `setupWebGLScene()`
- –†–∏–∑–∏–∫ memory leaks –ø—Ä–∏ –∑–º—ñ–Ω—ñ cleanup –≤ –æ–¥–Ω–æ–º—É –º—ñ—Å—Ü—ñ

**–†—ñ—à–µ–Ω–Ω—è (–≤–∏–∫–æ–Ω–∞–Ω–æ):**
- –î–æ–¥–∞–Ω–æ –æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏ –≤ `setupWebGLScene()`: `{ initBullets?: boolean, initRings?: boolean }`
- `SaveSlotBackgroundScene` —Ç–µ–ø–µ—Ä –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î `setupWebGLScene(canvas, scene, { initBullets: false, initRings: false })`
- Cleanup –ª–æ–≥—ñ–∫–∞ –ø–æ–≤–Ω—ñ—Å—Ç—é —Ü–µ–Ω—Ç—Ä–∞–ª—ñ–∑–æ–≤–∞–Ω–∞ —á–µ—Ä–µ–∑ `webglCleanup()`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –í–∏–¥–∞–ª–µ–Ω–æ ~40 —Ä—è–¥–∫—ñ–≤ –¥—É–±–ª—é–≤–∞–Ω–Ω—è cleanup –∫–æ–¥—É
- –ì–∞—Ä–∞–Ω—Ç–æ–≤–∞–Ω–∞ –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω—ñ—Å—Ç—å cleanup –º—ñ–∂ –æ–±–æ–º–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –ú–µ–Ω—à–µ —Ä–∏–∑–∏–∫ memory leaks

---

## 2. ‚úÖ –í–ò–ö–û–ù–ê–ù–û: –ì—ñ–≥–∞–Ω—Ç—Å—å–∫–∏–π SaveSlotBackgroundScene.tsx (1149 ‚Üí ~120 —Ä—è–¥–∫—ñ–≤)

**–ü—Ä–æ–±–ª–µ–º–∞:**
–û–¥–∏–Ω —Ñ–∞–π–ª –º—ñ—Å—Ç–∏–≤:
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—é (—Ä—è–¥–∫–∏ 36-154)
- –£—Ç–∏–ª—ñ—Ç–∏ –¥–ª—è –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è (—Ä—è–¥–∫–∏ 195-905)
- –õ–æ–≥—ñ–∫—É —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è —Å—Ü–µ–Ω–∏ (title, arch, creatures)
- WebGL setup —Ç–∞ render loop
- Cleanup –ª–æ–≥—ñ–∫—É

**–†—ñ—à–µ–Ω–Ω—è (–≤–∏–∫–æ–Ω–∞–Ω–æ):**
–†–æ–∑–±–∏—Ç–æ –Ω–∞ –º–æ–¥—É–ª—ñ:
```typescript
// save-slot-scene-config.ts - –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∏ —Ç–∞ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è (119 —Ä—è–¥–∫—ñ–≤)
// save-slot-scene-utils.ts - —É—Ç–∏–ª—ñ—Ç–∏ –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è (330 —Ä—è–¥–∫—ñ–≤)
// save-slot-scene-layout.ts - –ª–æ–≥—ñ–∫–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è title/arch/creatures (572 —Ä—è–¥–∫–∏)
// SaveSlotBackgroundScene.tsx - —Ç—ñ–ª—å–∫–∏ React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∑ render loop (~120 —Ä—è–¥–∫—ñ–≤)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –°–∫–æ—Ä–æ—á–µ–Ω–æ –∑ 1149 –¥–æ ~120 —Ä—è–¥–∫—ñ–≤ (–∑–º–µ–Ω—à–µ–Ω–Ω—è –Ω–∞ ~90%)
- –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∏ –≤–∏–Ω–µ—Å–µ–Ω—ñ –≤ –æ–∫—Ä–µ–º–∏–π —Ñ–∞–π–ª –¥–ª—è –ª–µ–≥–∫–æ–≥–æ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è
- –£—Ç–∏–ª—ñ—Ç–∏ –∫–ª–æ–Ω—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–∞ –ø–µ—Ä–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏
- –õ–æ–≥—ñ–∫–∞ layout —ñ–∑–æ–ª—å–æ–≤–∞–Ω–∞ —Ç–∞ —Ç–µ—Å—Ç–æ–≤–∞–Ω–∞ –æ–∫—Ä–µ–º–æ
- –õ–µ–≥—à–µ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Ç–∞ —Ä–æ–∑—à–∏—Ä—é–≤–∞—Ç–∏ —Ñ—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å

---

## 3. üü° –í–ò–°–û–ö–ò–ô –ü–†–Ü–û–†–ò–¢–ï–¢: –ù–∞–¥–º—ñ—Ä–Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è `any` —Ç–∏–ø—ñ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:**
96 –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—å `any` —Ç–∏–ø—ñ–≤ –≤ UI –∫–æ–¥—ñ:
- `src/ui/renderers/objects/PlayerUnitObjectRenderer.ts` - 33 –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è
- `src/ui/renderers/objects/ExplosionObjectRenderer.ts` - 13 –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—å
- `src/ui/screens/SaveSlotSelect/SaveSlotBackgroundScene.tsx` - 15 –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω—å
- –Ü–Ω—à—ñ —Ñ–∞–π–ª–∏

**–†—ñ—à–µ–Ω–Ω—è:**
–ó–∞–º—ñ–Ω–∏—Ç–∏ `any` –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ñ —Ç–∏–ø–∏ –∞–±–æ generics:
```typescript
// –ó–∞–º—ñ—Å—Ç—å: function process(data: any)
// –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏: function process<T>(data: T) –∞–±–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π —Ç–∏–ø
```

**–ï—Ñ–µ–∫—Ç:** –ö—Ä–∞—â–∞ —Ç–∏–ø–æ–±–µ–∑–ø–µ–∫–∞, –º–µ–Ω—à–µ –ø–æ–º–∏–ª–æ–∫ –ø—ñ–¥ —á–∞—Å —Ä–æ–∑—Ä–æ–±–∫–∏.

---

## 4. üü° –°–ï–†–ï–î–ù–Ü–ô –ü–†–Ü–û–†–ò–¢–ï–¢: –î—É–±–ª—é–≤–∞–Ω–Ω—è render loop –ª–æ–≥—ñ–∫–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `SaveSlotBackgroundScene.tsx` (—Ä—è–¥–∫–∏ 1140-1162) –º–∞—î –≤–ª–∞—Å–Ω–∏–π render loop
- `useSceneCanvas.ts` –º–∞—î —Å—Ö–æ–∂–∏–π render loop
- –û–±–∏–¥–≤–∞ —Ä–æ–±–ª—è—Ç—å: `setSceneTimelineTimeMs`, `flushChanges`, `applyChanges`, `syncBuffers`, `render`, effects

**–†—ñ—à–µ–Ω–Ω—è:**
–°—Ç–≤–æ—Ä–∏—Ç–∏ —Å–ø—ñ–ª—å–Ω–∏–π `useWebGLRenderLoop` —Ö—É–∫ –∞–±–æ —Ñ—É–Ω–∫—Ü—ñ—é:
```typescript
// useWebGLRenderLoop.ts
export const useWebGLRenderLoop = (
  webglRenderer: WebGLSceneRenderer,
  scene: SceneObjectManager,
  effects?: RenderEffect[]
) => { /* ... */ }
```

**–ï—Ñ–µ–∫—Ç:** DRY –ø—Ä–∏–Ω—Ü–∏–ø, –ª–µ–≥—à–µ –¥–æ–¥–∞–≤–∞—Ç–∏ –Ω–æ–≤—ñ –µ—Ñ–µ–∫—Ç–∏.

---

## 5. üü° –°–ï–†–ï–î–ù–Ü–ô –ü–†–Ü–û–†–ò–¢–ï–¢: –í–µ–ª–∏–∫—ñ renderer –∫–ª–∞—Å–∏

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `ObjectsRendererManager.ts` - –≤–µ–ª–∏–∫–∏–π –∫–ª–∞—Å (500+ —Ä—è–¥–∫—ñ–≤)
- `PlayerUnitObjectRenderer.ts` - –±–∞–≥–∞—Ç–æ `any` —Ç–∏–ø—ñ–≤ (33 –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è)
- –°–∫–ª–∞–¥–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –º—ñ–∂ renderer'–∞–º–∏

**–†—ñ—à–µ–Ω–Ω—è:**
- –†–æ–∑–±–∏—Ç–∏ `ObjectsRendererManager` –Ω–∞ –º–µ–Ω—à—ñ –∫–ª–∞—Å–∏ –∑–∞ —Ç–∏–ø–æ–º –æ–±'—î–∫—Ç—ñ–≤
- –í–∏–ø—Ä–∞–≤–∏—Ç–∏ —Ç–∏–ø–∏ –≤ `PlayerUnitObjectRenderer`
- –í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ composition –∑–∞–º—ñ—Å—Ç—å –≤–µ–ª–∏–∫–æ–≥–æ –∫–ª–∞—Å—É

**–ï—Ñ–µ–∫—Ç:** –õ–µ–≥—à–µ —Ç–µ—Å—Ç—É–≤–∞—Ç–∏, –º–µ–Ω—à–µ coupling.

---

## –î–æ–¥–∞—Ç–∫–æ–≤—ñ –ø—Ä–æ–±–ª–µ–º–∏

- **–í—ñ–¥—Å—É—Ç–Ω—ñ—Å—Ç—å error boundaries** –¥–ª—è WebGL –ø–æ–º–∏–ª–æ–∫
- **–ù–µ–º–∞—î fallback** —è–∫—â–æ WebGL –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π
- **–°–∫–ª–∞–¥–Ω—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ –º—ñ–∂ —Ö—É–∫–∞–º–∏** —á–µ—Ä–µ–∑ refs (–ø—Ä–∏–π–Ω—è—Ç–Ω–æ, –∞–ª–µ –º–æ–∂–Ω–∞ –ø–æ–∫—Ä–∞—â–∏—Ç–∏)
- **–í–µ–ª–∏–∫—ñ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∏ VoidCamp** - –º–æ–∂–ª–∏–≤–æ –ø–æ—Ç—Ä–µ–±—É—é—Ç—å —Ä–æ–∑–±–∏—Ç—Ç—è

---

## –ü—Ä—ñ–æ—Ä–∏—Ç–µ—Ç–∏

1. ‚úÖ **–í–ò–ö–û–ù–ê–ù–û:** –ü—Ä–æ–±–ª–µ–º–∞ #1 (cleanup –¥—É–±–ª—é–≤–∞–Ω–Ω—è) - –≤–∏–ø—Ä–∞–≤–ª–µ–Ω–æ
2. ‚úÖ **–í–ò–ö–û–ù–ê–ù–û:** –ü—Ä–æ–±–ª–µ–º–∞ #2 (–≤–µ–ª–∏–∫–∏–π —Ñ–∞–π–ª) - —Ä–æ–∑–±–∏—Ç–æ –Ω–∞ –º–æ–¥—É–ª—ñ
3. üü° **–í–ò–°–û–ö–ò–ô:** –ü—Ä–æ–±–ª–µ–º–∞ #3 (`any` —Ç–∏–ø–∏) - —Ç–∏–ø–æ–±–µ–∑–ø–µ–∫–∞
4. üü° **–°–ï–†–ï–î–ù–Ü–ô:** –ü—Ä–æ–±–ª–µ–º–∞ #4 (render loop –¥—É–±–ª—é–≤–∞–Ω–Ω—è) - DRY
5. üü° **–°–ï–†–ï–î–ù–Ü–ô:** –ü—Ä–æ–±–ª–µ–º–∞ #5 (–≤–µ–ª–∏–∫—ñ renderer –∫–ª–∞—Å–∏) - –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞
