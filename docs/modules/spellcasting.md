# SpellcastingModule

## Призначення
Керує доступними спелами, їх розблокуванням, кулдаунами та кастом. Публікує опції для UI й делегує поведінку спеціалізованим обробникам.

## Залежності
- `DataBridge` — пушить доступні варіанти у `SPELL_OPTIONS_BRIDGE_KEY` для підписників React.
- `SceneObjectManager` — потрібен поведінкам спелів для рендеру снарядів/ефектів.
- `NecromancerModule` — читає ресурси (mana/sanity), позиції спавнів і статус карти.
- `BricksModule` — отримує позиції та список цеглин, застосовує шкоду.
- `BonusesModule` — дає множник сили спела, підписка на зміни бонусів.
- Опційно `ExplosionModule` — для ефектів типу AOE.
- `getSkillLevel(skillId)` — перевірка умов розблокування.

## Життєвий цикл
- `initialize()` — обнуляє кулдауни, обчислює множники бонусів, оновлює статус розблокувань і пушить опції.
- `reset()` / `load()` — скидають кулдауни, очищують поведінки, перевіряють розблокування та оновлюють UI.

## Основні методи
- `tick(deltaMs)` — зменшує кулдауни, оновлює поведінки активних спелів та перепушує опції при змінах.
- `tryCastSpell(spellId, target)` — перевіряє розблокування, ресурси, кулдаун, нормалізує ціль до меж карти, витрачає ресурси й викликає поведінку спела.
- `hasResourcesForAnySpell()` — перевіряє, чи є хоч один доступний спел без кулдауну та з достатніми ресурсами.

## Збереження
Стан кулдаунів і списку опцій не серіалізується (визначається під час бою).

## Особливості
- Визначає точку каста: або найближчий спавн некроманта, або центр карти, якщо спавнів немає.
- Поведінки спелів інкапсульовані в `SpellBehaviorRegistry`, що дозволяє додавати нові типи без змін модуля.
