# ResourcesModule

## Призначення
Відстежує глобальні запаси ресурсів, здобич за забіг, пасивний дохід і підсумки бою.

## Залежності
- `DataBridge` — публікує три ключі: `resources/totals`, `resources/runSummary`, `resources/runDuration`.
- `UnlockService` — визначає, які ресурси показувати гравцю.
- `BonusesModule` — застосовує пасивний дохід та інші множники.

## Життєвий цикл
- `initialize()` — обчислює видимі ресурси й надсилає початкові значення.
- `reset()` — очищує запаси, підсумки й таймер забігу.
- `load(data)` — застосовує збережені запаси та статистику знищених цеглин.

## Основні методи
- `tick(deltaMs)` — додає пасивний дохід, оновлює видимість ресурсів і таймер забігу.
- `startRun()` / `finishRun()` / `cancelRun()` — керують станом забігу й фінальним підсумком.
- `grantResources(amount, options)` — додає ресурси гравцю, враховуючи бонуси; опціонально включає їх у підсумок забігу.
- `notifyBrickDestroyed()` — збільшує лічильник зруйнованих цеглин для статистики.
- `canAfford(amount)` / `spendResources(amount)` — перевіряють і списують ресурси.
- `getTotals()` / `getRunGains()` — копії поточних запасів і здобичі.
- `isRunSummaryAvailable()` — чи можна показати підсумок.

## Збереження
- Серіалізує загальні запаси та кількість зруйнованих цеглин. Поточний забіг не зберігається (розраховується наново при старті).

## Особливості
- Підтримує відкладений пасивний дохід: залишки дробових значень накопичуються в `passiveIncomeRemainder`.
- Контролює видимість ресурсів через UnlockService, щоб приховати ще не відкриті валюти.
