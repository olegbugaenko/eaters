# Файлова структура проєкту

Короткий путівник по ключових директоріях, щоб швидко знайти потрібний код або документацію.

## Корінь репозиторію
- `src/` — вихідний код.
- `docs/` — структурована документація (цей розділ).
- `public/` — статичні файли (шрифти, аудіо, маніфести).
- `tests/` — тестові збірки для логіки.
- `vendor/` — підключені сторонні ресурси (наприклад, шейдери).

## Логіка (`src/logic`)
- `core/` — каркас застосунку: `Application.ts` збирає сервіси та модулі, `DataBridge.ts` прокидає реактивні дані в UI, `ServiceContainer.ts` зберігає сінглтони.
  - `core/factories/` — `StateFactory` та його наслідники для уніфікованого створення станів модулів.
- `services/` — спільні сервіси: `SaveManager`, `GameLoop`, `SceneObjectManager`, `MovementService`, `UnlockService`.
- `helpers/` — загальні хелпери, які використовуються кількома модулями:
  - `angle.helper.ts`, `vector.helper.ts` — математичні операції з кутами та векторами.
  - `geometry.const.ts` — геометричні константи.
  - `scene-fill.helper.ts`, `scene-color.helper.ts` — робота з візуальними ефектами сцени.
  - `time.helper.ts`, `numbers.helper.ts` — утиліти для часу та чисел.
  - `particle-emitter.helper.ts` — допоміжні функції для емітерів часток.
- `modules/` — ігрові модулі, згруповані по доменах:
  - `active-map/` — бойові системи (мапи, цеглини, юніти, автоматика, закляття).
  - `camp/` — розвиток між забігами (будівлі, крафт, дизайн юнітів, модулі юнітів, дерево скілів).
  - `scene/` — суто візуальні ефекти (арки, вибухи, вогняні кулі, аури).
  - `shared/` — персистентні або допоміжні модулі (бонуси, ресурси, статистика, аудіо, тестовий час).
- `interfaces/` — спільні інтерфейси для модулів (наприклад, конфіг для руйнівних об’єктів).
- `utils/` — допоміжні утиліти (просторові індекси, форматування, аудіо-налаштування).

### Структура модуля та паттерни назв файлів

Кожен модуль має стандартизовану структуру файлів з чіткими паттернами назв:

**Обов'язкові файли:**
- `<module-name>.module.ts` — основний клас модуля, реалізує `GameModule`.

**Опціональні файли (за потреби):**
- `<module-name>.types.ts` — типи та інтерфейси, специфічні для модуля. Експортуються для використання в інших модулях або тестах.
- `<module-name>.const.ts` — константи модуля (магічні числа, дефолтні значення, ключі для DataBridge).
- `<module-name>.helpers.ts` — допоміжні функції, специфічні для модуля. Якщо функція може бути корисною для інших модулів — винести в `logic/helpers/`.
- `<module-name>.state-factory.ts` — фабрика станів, що наслідує `StateFactory` (див. [state-factory.md](state-factory.md)). Використовується для уніфікованого створення локальних станів модуля.
- `<module-name>.factory.ts` — інші фабрики (не state-factory), якщо потрібні.

**Приклади структури:**
```
bricks/
  ├── bricks.module.ts          # Основний модуль
  ├── bricks.types.ts           # Типи (InternalBrickState, BrickEffectType)
  ├── bricks.const.ts           # Константи (BRICKS_STATE_BRIDGE_KEY)
  ├── bricks.helpers.ts         # Хелпери (calculateBrickRewards)
  ├── bricks.state-factory.ts  # StateFactory для створення станів
  └── bricks.fill.helper.ts     # Специфічний хелпер (можна об'єднати з helpers.ts)
```

**Рекомендації:**
- Якщо хелпер використовується тільки в межах одного модуля — залишити в `<module-name>.helpers.ts`.
- Якщо хелпер може бути корисним для інших модулів — винести в `logic/helpers/<name>.helper.ts`.
- Типи, які використовуються зовні модуля (в інших модулях, тестах, UI), мають бути експортовані з `<module-name>.types.ts`.
- Константи, які використовуються зовні модуля, мають бути експортовані з `<module-name>.const.ts`.

## UI (`src/ui`)
- `screens/` — React-екрани (камп, мапа та інші стани).
- `shared/` — загальні компоненти та стилі.
- `renderers/` — WebGL-рендерери та примітиви, що читають сцену через `SceneObjectManager`.
- `contexts/` — React-контексти (`AppLogicContext` тощо) для зв’язку з логікою.
- `utils/` — UI-хелпери та хуки.

## Бази даних та типи
- `src/db/` — статичні конфіги (карти, юніти, спели, цеглини, бонуси).
- `src/types/` — типи для ресурсів, юнітів, бонусів, таргетингу та умов відкриття контенту.

## Документація
Кожна вкладена папка має власний `index.md` із коротким змістом. Починати варто з `docs/index.md`, далі — за посиланнями у відповідних розділах.
